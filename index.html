<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SQL Quest</title>
  <style>
    body {
      margin: 0;
      font-family: "Segoe UI", sans-serif;
      background: #f9fafb;
      color: #111;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      height: 100vh;
    }
    header {
      width: 100%;
      padding: 1rem;
      text-align: center;
      background: #2563eb;
      color: #fff;
      font-size: 1.25rem;
      font-weight: 600;
    }
    #game {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      padding: 1rem;
      width: 100%;
      max-width: 600px;
    }
    .scene {
      margin: 1rem 0;
      padding: 1rem;
      background: #fff;
      border-radius: 1rem;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      width: 100%;
      min-height: 200px;
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      align-items: center;
      gap: 0.5rem;
      font-size: 1.25rem;
    }
    .customer, .item, .traveler, .city {
      padding: 0.5rem 0.75rem;
      border-radius: 0.75rem;
      background: #f3f4f6;
      cursor: pointer;
      transition: background 0.2s;
    }
    .customer.glow, .item.glow, .traveler.glow, .city.glow {
      background: #bbf7d0;
      font-weight: bold;
    }
    .blocks {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 0.5rem;
      margin-top: 1rem;
    }
    .block {
      padding: 0.5rem 1rem;
      border-radius: 9999px;
      background: #e5e7eb;
      cursor: grab;
      font-weight: 600;
      transition: background 0.2s;
    }
    .block:hover { background: #d1d5db; }
    #query {
      margin-top: 1rem;
      padding: 0.75rem;
      background: #1e293b;
      color: #f8fafc;
      font-family: monospace;
      font-size: 0.9rem;
      border-radius: 0.5rem;
      white-space: pre-wrap;
      width: 100%;
      overflow-x: auto;
    }
    #nextBtn {
      margin-top: 1rem;
      padding: 0.75rem 1.25rem;
      font-size: 1rem;
      border: none;
      border-radius: 0.75rem;
      background: #16a34a;
      color: #fff;
      font-weight: 600;
      cursor: pointer;
      display: none;
    }
    #nextBtn:active { transform: scale(0.98); }
  </style>
</head>
<body>
  <header>SQL Quest</header>
  <div id="game">
    <div id="levelTitle"></div>
    <div class="scene" id="scene"></div>
    <div class="blocks" id="blocks"></div>
    <div id="query"></div>
    <button id="nextBtn">Next Level →</button>
  </div>  <script>
    const levels = [
      {
        title: "Level 1: Show everyone (SELECT *)",
        scene: ["Alice", "Bob", "Charlie"],
        answer: "SELECT * FROM customers;",
        highlight: () => [0,1,2],
        blocks: ["SELECT *", "FROM customers"]
      },
      {
        title: "Level 2: Find coffee drinkers (WHERE)",
        scene: ["☕ Alice", "🍵 Bob", "☕ Charlie"],
        answer: "SELECT name FROM customers WHERE drink = 'coffee';",
        highlight: (scene) => scene.map((c,i)=>c.includes("☕")?i:null).filter(i=>i!==null),
        blocks: ["SELECT name", "FROM customers", "WHERE drink = coffee"]
      },
      {
        title: "Level 3: Count all items (COUNT)",
        scene: ["📦 Box", "📦 Box", "📦 Box", "📦 Box"],
        answer: "SELECT COUNT(*) FROM warehouse;",
        highlight: (scene) => [0,1,2,3],
        blocks: ["SELECT COUNT(*)", "FROM warehouse"]
      },
      {
        title: "Level 4: Group travelers by flight (GROUP BY)",
        scene: ["✈️ Flight A - Sam", "✈️ Flight B - Rita", "✈️ Flight A - Tom"],
        answer: "SELECT flight, COUNT(*) FROM travelers GROUP BY flight;",
        highlight: () => [0,1,2],
        blocks: ["SELECT flight, COUNT(*)", "FROM travelers", "GROUP BY flight"]
      },
      {
        title: "Level 5: Join passports with travelers (JOIN)",
        scene: ["Traveler Sam", "Traveler Rita", "Passport Sam", "Passport Rita"],
        answer: "SELECT * FROM travelers JOIN passports ON travelers.name = passports.name;",
        highlight: () => [0,1,2,3],
        blocks: ["SELECT *", "FROM travelers", "JOIN passports", "ON travelers.name = passports.name"]
      },
      {
        title: "Level 6: Advanced - Filter by city population (WHERE + ORDER BY)",
        scene: ["🏙️ NY - 8M", "🏙️ LA - 4M", "🏙️ SF - 1M"],
        answer: "SELECT city FROM cities WHERE population > 2000000 ORDER BY population DESC;",
        highlight: (scene) => [0,1],
        blocks: ["SELECT city", "FROM cities", "WHERE population > 2000000", "ORDER BY population DESC"]
      }
    ];

    let currentLevel = 0;

    function renderLevel() {
      const level = levels[currentLevel];
      document.getElementById("levelTitle").innerText = level.title;
      const sceneDiv = document.getElementById("scene");
      sceneDiv.innerHTML = "";
      level.scene.forEach((s,i)=>{
        const div = document.createElement("div");
        div.className = "customer";
        div.textContent = s;
        sceneDiv.appendChild(div);
      });
      const blocksDiv = document.getElementById("blocks");
      blocksDiv.innerHTML = "";
      level.blocks.forEach(b=>{
        const div = document.createElement("div");
        div.className = "block";
        div.textContent = b;
        div.onclick = ()=>{
          document.getElementById("query").textContent += (document.getElementById("query").textContent?"\n":"") + b;
          checkAnswer();
        };
        blocksDiv.appendChild(div);
      });
      document.getElementById("query").textContent = "";
      document.getElementById("nextBtn").style.display = "none";
    }

    function checkAnswer() {
      const level = levels[currentLevel];
      const query = document.getElementById("query").textContent.replace(/\n/g," ").trim();
      if(query === level.answer.replace(/\n/g," ").trim()){
        const sceneDiv = document.getElementById("scene");
        const children = Array.from(sceneDiv.children);
        (typeof level.highlight === "function" ? level.highlight(level.scene): level.highlight).forEach(i=>{
          children[i].classList.add("glow");
        });
        document.getElementById("nextBtn").style.display = "block";
      }
    }

    document.getElementById("nextBtn").onclick = ()=>{
      currentLevel++;
      if(currentLevel < levels.length){
        renderLevel();
      } else {
        document.getElementById("game").innerHTML = "<h2>🎉 You finished all levels! 🎉</h2>";
      }
    };

    renderLevel();
  </script></body>
</html>
